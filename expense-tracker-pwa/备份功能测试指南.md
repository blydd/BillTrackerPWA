# 备份功能测试指南

## 测试环境要求

### 支持的浏览器
- ✅ Chrome（桌面版和移动版）
- ✅ Firefox（桌面版和移动版）
- ✅ Safari（桌面版和移动版）
- ✅ Edge（桌面版和移动版）
- ✅ 其他基于 Chromium 的浏览器

### 测试设备
- 桌面电脑（Windows/Mac/Linux）
- 手机（iOS/Android）
- 平板电脑

## 测试步骤

### 1. 基础功能测试

#### 1.1 访问设置页面
1. 打开应用：http://localhost:5173
2. 点击底部导航栏的"设置"选项卡
3. 找到"数据备份"区域

#### 1.2 备份方式选择测试
1. 确认默认选择"本地下载"
2. 尝试选择"Google Drive"（应该显示为禁用状态）
3. 选择"禁用备份"，确认相关选项隐藏
4. 重新选择"本地下载"

#### 1.3 备份间隔设置测试
1. 测试各个间隔选项：每天、每3天、每周、禁用自动备份
2. 确认选择后配置能正确保存

### 2. 备份功能测试

#### 2.1 准备测试数据
1. 添加几条测试账单
2. 创建自定义账单类型
3. 添加归属人
4. 添加支付方式

#### 2.2 立即备份测试
1. 点击"立即备份"按钮
2. 确认按钮显示"备份中..."状态
3. 等待备份完成
4. 检查浏览器下载文件夹，确认生成备份文件
5. 文件名格式应为：`账单备份_YYYYMMDD_HHMMSS.json`

#### 2.3 备份文件内容验证
1. 用文本编辑器打开备份文件
2. 确认 JSON 格式正确
3. 验证包含以下数据：
   - version: "1.0"
   - timestamp: 时间戳
   - appName: "账单管理 PWA"
   - data: 包含 bills、categories、owners、paymentMethods

### 3. 恢复功能测试

#### 3.1 数据恢复测试
1. 删除一些测试数据
2. 点击"恢复数据"按钮
3. 选择刚才生成的备份文件
4. 确认恢复提示
5. 等待页面重新加载
6. 验证数据是否完全恢复

#### 3.2 完整恢复测试
1. 清空所有数据（设置 → 清空所有数据）
2. 使用备份文件恢复
3. 确认所有数据完全恢复

### 4. 移动端测试

#### 4.1 iOS Safari 测试
1. 在 iPhone/iPad 上打开应用
2. 测试备份功能
3. 确认文件能正确下载
4. 测试恢复功能

#### 4.2 Android Chrome 测试
1. 在 Android 设备上打开应用
2. 重复桌面端的所有测试步骤
3. 特别注意文件下载和选择的体验

### 5. 自动备份测试

#### 5.1 配置自动备份
1. 设置备份间隔为"每天"
2. 检查浏览器控制台，确认定时器启动
3. 手动触发时间检查（需要修改最后备份时间）

#### 5.2 备份状态显示
1. 执行备份后，确认显示"最后备份时间"
2. 时间格式应为中文本地化格式

### 6. 错误处理测试

#### 6.1 无效备份文件测试
1. 创建一个无效的 JSON 文件
2. 尝试恢复，确认显示错误提示
3. 测试空文件、格式错误等情况

#### 6.2 网络异常测试
1. 断开网络连接
2. 测试本地备份功能（应该正常工作）
3. 测试恢复功能（应该正常工作）

## 预期结果

### 成功标准
- ✅ 所有浏览器都能正常备份和恢复
- ✅ 移动端体验良好
- ✅ 备份文件格式正确
- ✅ 数据完整性保证
- ✅ 错误处理友好
- ✅ 界面响应及时

### 常见问题排查

#### 问题1：备份文件下载失败
- 检查浏览器下载设置
- 确认没有弹窗拦截
- 尝试不同浏览器

#### 问题2：恢复时选择文件无响应
- 确认文件格式为 .json
- 检查文件大小是否合理
- 尝试重新生成备份文件

#### 问题3：移动端文件操作问题
- iOS：确认 Safari 版本支持
- Android：检查 Chrome 版本
- 尝试使用其他浏览器

## 测试报告模板

```
测试环境：
- 浏览器：
- 操作系统：
- 设备类型：

测试结果：
- 备份功能：✅/❌
- 恢复功能：✅/❌
- 移动端兼容：✅/❌
- 自动备份：✅/❌

发现问题：
1. 
2. 
3. 

建议改进：
1. 
2. 
3. 
```