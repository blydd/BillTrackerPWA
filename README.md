# BillTracker PWA - 账单管理应用

一个功能完善的渐进式 Web 应用（PWA），支持多人账单记录、智能支付方式管理、数据统计分析。可安装到手机桌面，离线使用，数据本地存储。

## 在线体验

🌐 访问地址：[即将部署]

## 系统要求

- 现代浏览器（Chrome、Safari、Edge、Firefox）
- 支持 PWA 的移动设备或桌面浏览器
- 建议使用 Chrome 或 Safari 以获得最佳体验

## 核心功能

### 📝 账单管理
- **三种交易类型**：支出、收入、不计入
- **多标签支持**：每个账单可添加多个类型标签
- **智能余额更新**：创建/修改/删除账单自动更新支付方式余额
- **按日分组显示**：每日自动汇总收入、支出和不计入金额
- **紧凑布局**：优化的移动端显示，标签自动换行
- **筛选功能**：
  - 按交易类型筛选（支出/收入/不计入）
  - 按账户类型筛选（信贷方式/储蓄方式）
  - 按归属人筛选
  - 按账单类型筛选
  - 按日期范围筛选

### 💳 支付方式管理
- **信贷方式**：信用卡、花呗、白条等
  - 信用额度管理
  - 欠费追踪（支持溢缴款，欠费可为负数）
  - 账单日设置
  - 自动计算可用额度
- **储蓄方式**：微信、支付宝、银行卡等
  - 余额管理
  - 实时更新
- **归属人隔离**：每个人独立的支付方式，防止误操作
- **自定义排序**：拖动调整支付方式显示顺序
- **智能显示**：创建账单时只显示对应归属人的支付方式

### 👥 多人账单
- 支持多个归属人（默认：男主、女主）
- 每个归属人独立的支付方式
- 按归属人统计支出
- **自定义排序**：拖动调整归属人显示顺序

### 📊 统计分析
- **总览统计**：总收入、总支出、净收入、不计入
- **交易类型筛选**：支持按支出/收入/不计入筛选统计数据
- **多维度统计**：
  - 按账单类型统计
  - 按归属人统计（显示收入/支出/不计入明细）
  - 按支付方式统计
- **Tab 切换**：快速切换不同统计维度
- **时间范围筛选**：
  - 本月、上月、今年、全部
  - 自定义日期范围（支持按月选择或自定义范围）
- **点击查看详情**：点击统计数据查看对应的账单列表
- **详情操作**：在详情页面可直接编辑或删除账单

### 📤 数据导入导出
- **导出功能**：
  - 导出为 CSV 格式
  - 支持筛选后导出
  - 包含完整账单信息（日期、金额、交易类型、账单类型、归属人、支付方式、备注）
  - 文件名包含时间戳
- **导入功能**：
  - 支持 CSV 格式导入
  - 自动匹配账单类型、归属人、支付方式
  - 导入前预览数据

### 🎯 账单类型管理
- **丰富的预设类型**：
  - 支出类型（31个）：衣、食、外卖、下馆子、超市、赶集、转给妈、住、电费、水费、燃气、房租、行、加油、停车费、轿车、摩托、购物、京东、拼多多、淘宝、米乐、教育、医疗、娱乐、电影、保险、话费、人情、老家装修、其他
  - 收入类型（3个）：工资、保险理赔、其他
  - 不计入类型（2个）：还信用卡、对冲
- **自定义排序**：拖动调整账单类型显示顺序
- **灵活管理**：可添加、编辑、删除账单类型

### 🔄 初始化功能
- 一键创建基础数据
- 为"男主"和"女主"各生成一套完整的支付方式
- 预设常用账单类型和归属人
- 支持重新初始化（会清空所有数据）

### 🎨 用户体验
- **PWA 支持**：可安装到手机桌面，像原生应用一样使用
- **离线可用**：支持离线访问和操作
- **响应式设计**：完美适配手机、平板、桌面
- **紧凑布局**：优化标签和按钮间距，提升信息密度
- **实时反馈**：操作即时响应，状态清晰可见
- **深色主题**：自动适配系统主题

## 快速开始

### 在线使用

1. 访问应用网址
2. 点击浏览器菜单中的"添加到主屏幕"或"安装"
3. 应用将添加到手机桌面，可离线使用

### 本地开发

```bash
# 进入项目目录
cd expense-tracker-pwa

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产版本
npm run preview
```

## 使用教程

### 初次使用
1. 打开应用，进入"设置"页面
2. 点击"初始化"创建基础数据（账单类型、归属人、支付方式）
3. 根据需要在"设置"中管理账单类型、归属人和支付方式

### 添加账单
1. 在"账单"页面点击右上角"添加账单"
2. 选择交易类型（支出/收入/不计入）
3. 输入金额和日期时间
4. 选择归属人
5. 选择支付方式（只显示该归属人的支付方式）
6. 选择账单类型（可多选）
7. 可选填写备注
8. 点击"保存"

### 管理支付方式
1. 进入"设置" → "支付方式管理"
2. 选择账户类型（信贷/储蓄）
3. 选择归属人（顶部横向滚动按钮）
4. 点击"添加支付方式"
5. 点击"编辑"修改现有支付方式
6. 拖动排序调整显示顺序

### 查看统计
1. 进入"统计"页面
2. 选择时间范围（本月/上月/今年/全部/自定义）
3. 选择交易类型（全部/支出/收入/不计入）
4. 切换统计维度（按类型/按归属人/按支付方式）
5. 点击统计项查看详细账单列表

## 技术栈

- **前端框架**：React 18 + TypeScript
- **构建工具**：Vite
- **样式方案**：Tailwind CSS
- **数据库**：Dexie.js (IndexedDB 封装)
- **图表库**：Recharts
- **图标库**：Lucide React
- **日期处理**：date-fns
- **PWA 支持**：vite-plugin-pwa

## 数据存储

应用使用 IndexedDB 存储数据，数据保存在浏览器本地。

**数据安全**：
- 数据仅存储在本地浏览器，不会上传到云端
- 支持数据导出备份（CSV 格式）
- 清除浏览器数据会删除所有账单
- 建议定期导出数据备份

**数据库特性**：
- 基于 IndexedDB，支持大量数据存储
- 响应式查询，自动更新 UI
- 支持事务处理，确保数据一致性
- 完整的索引优化，查询性能优秀

## 项目结构

```
expense-tracker-pwa/
├── src/
│   ├── components/          # React 组件
│   │   ├── BillListView.tsx        # 账单列表
│   │   ├── BillFormModal.tsx       # 账单表单
│   │   ├── BillFilterModal.tsx     # 筛选弹窗
│   │   ├── StatisticsView.tsx      # 统计页面
│   │   ├── SettingsView.tsx        # 设置页面
│   │   ├── CategoryManagementView.tsx    # 类型管理
│   │   ├── OwnerManagementView.tsx       # 归属人管理
│   │   └── PaymentMethodManagementView.tsx # 支付方式管理
│   ├── services/            # 业务逻辑
│   │   ├── db.ts                   # 数据库配置
│   │   ├── billService.ts          # 账单服务
│   │   ├── statisticsService.ts    # 统计服务
│   │   └── exportService.ts        # 导出服务
│   ├── models/              # 数据模型
│   │   └── types.ts                # TypeScript 类型定义
│   ├── App.tsx              # 主应用组件
│   ├── main.tsx             # 应用入口
│   └── index.css            # 全局样式
├── public/                  # 静态资源
├── index.html               # HTML 模板
├── vite.config.ts           # Vite 配置
├── tailwind.config.js       # Tailwind 配置
└── package.json             # 项目配置
```

## 特色功能

### 🔐 智能余额管理
- **自动更新**：创建/修改/删除账单自动更新支付方式余额
- **信贷方式**：
  - 自动计算可用额度（信用额度 - 欠费）
  - 支持溢缴款（欠费可为负数）
  - 超额提醒
- **储蓄方式**：实时余额追踪

### 👤 归属人隔离
- 每个归属人独立的支付方式
- 创建账单时只显示对应归属人的支付方式
- 防止误操作他人账户
- 支持自定义排序

### 🏷️ 灵活的账单类型
- **支出**：日常消费，金额为负数，计入支出统计
- **收入**：工资等收入，金额为正数，计入收入统计
- **不计入**：信用卡还款、账户转账等
  - 更新支付方式余额
  - 不计入收支统计
  - 每日汇总单独显示

### 💳 信用卡溢缴款支持
- 还款金额可超过欠费
- 欠费为负数表示溢缴款
- 可用额度自动增加

### 🔍 强大的筛选功能
- **多条件筛选**：支持同时按多个维度筛选
- **智能缓存**：筛选结果自动缓存，提升性能
- **筛选导出**：支持导出筛选后的账单数据

### 📊 统计详情查看
- 点击统计数据查看对应账单列表
- 支持在详情页面直接编辑或删除账单
- 数据变化后自动刷新统计
- 交易类型独立筛选，总览数据不受影响

## 部署

### Vercel 部署（推荐）

1. Fork 本仓库
2. 在 Vercel 中导入项目
3. 设置构建命令：
   - Build Command: `cd expense-tracker-pwa && npm run build`
   - Output Directory: `expense-tracker-pwa/dist`
4. 点击部署

### Netlify 部署

1. Fork 本仓库
2. 在 Netlify 中导入项目
3. 设置构建配置：
   - Base directory: `expense-tracker-pwa`
   - Build command: `npm run build`
   - Publish directory: `expense-tracker-pwa/dist`
4. 点击部署

### 自托管

```bash
# 构建项目
cd expense-tracker-pwa
npm run build

# dist 目录即为生产文件，可部署到任何静态服务器
```

## 开发计划

- [ ] 云端同步支持
- [ ] 数据自动备份
- [ ] 更多图表展示（饼图、折线图）
- [ ] 预算管理功能
- [ ] 账单搜索功能
- [ ] 定期账单提醒
- [ ] 账单附件（照片、发票）
- [ ] 多币种支持
- [ ] 主题自定义

## 相关文档

- [部署说明](./expense-tracker-pwa/部署说明.md)
- [快速启动](./expense-tracker-pwa/快速启动.md)
- [迁移指南](./expense-tracker-pwa/迁移指南.md)
- [项目完成说明](./expense-tracker-pwa/项目完成说明.md)
- [不计入类型账单使用说明](./不计入类型账单使用说明.md)
- [信用卡溢缴款功能说明](./信用卡溢缴款功能说明.md)
- [免费账户限制说明](./免费账户限制说明.md)
- [更新日志](./CHANGELOG.md)

## 贡献

欢迎提交 Issue 和 Pull Request！

## License

MIT License
